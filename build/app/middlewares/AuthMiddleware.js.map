{"version":3,"sources":["../../../src/app/middlewares/AuthMiddleware.js"],"names":["AuthMiddleware","auth","req","res","next","authHeader","headers","authorization","status","json","error","token","split","decoded","jwt","verify","authConfig","secret","userId","id","err"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;;;AAEA,MAAMA,cAAN,CAAqB;AACnB,QAAMC,IAAN,CAAWC,GAAX,EAAgBC,GAAhB,EAAqBC,IAArB,EAA2B;AACzB,UAAMC,UAAU,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAA/B;;AAEA,QAAI,CAACF,UAAL,EAAiB;AACf,aAAOF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB,CAAP;AACD;;AAED,UAAM,GAAGC,KAAH,IAAYN,UAAU,CAACO,KAAX,CAAiB,GAAjB,CAAlB;;AAEA,QAAI;AACF,YAAMC,OAAO,GAAG,MAAM,qBAAUC,sBAAIC,MAAd,EAAsBJ,KAAtB,EAA6BK,cAAWC,MAAxC,CAAtB;AAEAf,MAAAA,GAAG,CAACgB,MAAJ,GAAaL,OAAO,CAACM,EAArB;AAEA,aAAOf,IAAI,EAAX;AACD,KAND,CAME,OAAOgB,GAAP,EAAY;AACZ,aAAOjB,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB,CAAP;AACD;AACF;;AAnBkB;;eAsBN,IAAIV,cAAJ,E","sourcesContent":["import jwt from 'jsonwebtoken';\nimport { promisify } from 'util';\n\nimport authConfig from '../../config/auth';\n\nclass AuthMiddleware {\n  async auth(req, res, next) {\n    const authHeader = req.headers.authorization;\n\n    if (!authHeader) {\n      return res.status(401).json({ error: 'Token not privided' });\n    }\n\n    const [, token] = authHeader.split(' ');\n\n    try {\n      const decoded = await promisify(jwt.verify)(token, authConfig.secret);\n\n      req.userId = decoded.id;\n\n      return next();\n    } catch (err) {\n      return res.status(401).json({ error: 'Token invalid' });\n    }\n  }\n}\n\nexport default new AuthMiddleware();\n"],"file":"AuthMiddleware.js"}